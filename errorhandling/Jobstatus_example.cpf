{"version":2,"type":"job","id":"a27ca784-cae7-46a3-86b5-9d5c40be7299","name":"Jobstatus_example.cpf","label":"Jobstatus_example","description":"","created":1666039175896,"modified":1666039742548,"notes":"","parameters":{"server":"","target":"com.sas.ep.sascoder.execution.producers.VPP","action":"processFlow","priority":"Reserved"},"properties":{"left":"20","top":"20","width":"100","height":"60","region":"output","fillcolor":"#FCFCFC","linecolor":"#9a9a9a","tooltip":"","portsonly":false,"key":"control","visible":true,"readonly":false},"steps":[{"version":2,"type":"code","id":"6decdbae-1583-4cff-814d-bc32775e0a07","name":"","label":"initialize_job","description":"","created":1666039188451,"modified":1666040260757,"notes":"","parameters":{"server":"","target":"com.sas.ep.sascoder.execution.producers.VPP","action":"runSASCode","priority":"Reserved","code":"options nosyntaxcheck nodmssynchk; \n%let START_DTTM=%SYSFUNC(DATETIME(), DATETIME.);; \n%let output_table=orion.job_status; \n%let JOB_NAME=errorhandling;\n%let target_table=WORK.CLASS; \nlibname orion \"d:\\workshop\\orionstar\\orstar\";","snippet":"","resource":false},"properties":{"left":"50","top":"30","width":"100","height":"60","region":"output","fillcolor":"#E0E6F1","linecolor":"#6882a3","tooltip":"initialize_job","portsonly":true,"key":"control","visible":true}},{"version":2,"type":"code","id":"c0c3ce8b-0c56-4450-8487-b5b00af1ba24","name":"","label":"sas task","description":"","created":1666039663420,"modified":1666040341280,"notes":"","parameters":{"server":"","target":"com.sas.ep.sascoder.execution.producers.VPP","action":"runSASCode","priority":"Reserved","code":"/*Using Syserr to check return codes of SAS Datastep and Proc steps*/\nproc means data=sashelp.class;\nclass sex;\nvar wieght;\nrun;\n\n\n\nproc means data=sashelp.class;\nclass sex;\nvar weight;\nrun;\n","snippet":"","resource":false,"dependencies":["6decdbae-1583-4cff-814d-bc32775e0a07"]},"properties":{"left":"240","top":"30","width":"100","height":"60","region":"output","fillcolor":"#E0E6F1","linecolor":"#6882a3","tooltip":"sas task","portsonly":true,"key":"control","visible":true}},{"version":2,"type":"code","id":"69259c90-e290-4c0e-8847-6e67bbb04dc2","name":"","label":"Store Job Status","description":"","created":1666039314802,"modified":1666040341281,"notes":"","parameters":{"server":"","target":"com.sas.ep.sascoder.execution.producers.VPP","action":"runSASCode","priority":"Reserved","code":"%macro StoreRuntimeInformation(Table=);\n\t%IF NOT %SYMEXIST(JOB_NAME) %THEN %DO;\n\t\t%PUT WARNING: The macro variable JOB_NAME does not exist. Initializing the variable and giving it a default value.;\n\t\t%LET JOB_NAME = Unknown JOB;\n\t%END;\n\n\t%IF NOT %SYMEXIST(TARGET_TABLE) %THEN %DO;\n\t\t%PUT WARNING: The macro variable TARGET_TABLE does not exist. Initializing the variable and giving it a default value.;\n\t\t%LET TARGET_TABLE = Unknown table;\n\t%END;\n\n\t%IF NOT %SYMEXIST(START_DTTM) %THEN %DO;\n\t\t%PUT WARNING: The macro variable START_DTTM does not exist. Initializing the variable and giving it a default value.;\n\t\t%LET START_DTTM = %SYSFUNC(DATETIME(), DATETIME.);\n\t%END;\n\n\t%LET END_DTTM = %SYSFUNC(DATETIME(), DATETIME.);\n\t\n\t%LET returncode=0;\n \t%macro SetReturnCode;\n\t\t%if &SYSERR NE 0 %THEN %DO;\n\t\t\t%let returncode = &SYSERR;\n\t\t%end;\n\t\t%if &SYSRC NE 0 %THEN %DO;\n\t\t\t%let returncode = &SYSRC;\n\t\t%end;\n\t\t%if &SYSCC NE 0 %THEN %DO;\n\t\t\t%let returncode = &SYSCC;\n\t\t%end;\n\t%mend;\t\n\t%SetReturnCode;\n\n\tDATA WORK.JOB_STATUS;\n\t\tATTRIB USER_ID LENGTH = $32;\n\t\tATTRIB TARGET_TABLE LENGTH = $32;\n\t\tATTRIB JOB_NAME LENGTH = $80;\n\t\tATTRIB JOB_RC LENGTH = 8.;\n\t\tATTRIB ROWS_AFFECTED LENGTH = 8.;\n\t\tATTRIB START_DTTM LENGTH = 8. FORMAT=DATETIME20.;\n\t\tATTRIB END_DTTM LENGTH=8. FORMAT=DATETIME20.;\n\t\n\t\tUSER_ID = \"&SYSUSERID\";\n\t\tTARGET_TABLE = \"&TARGET_TABLE\";\n\t\tJOB_NAME = \"&JOB_NAME\";\n\t\tJOB_RC = &returncode;\n\t\tROWS_AFFECTED = &SQLOBS;\n\t\tSTART_DTTM = \"&START_DTTM\"dt;\n\t\tEND_DTTM = \"&END_DTTM\"dt;\n\tRUN;\n\n\tPROC SQL;\n\t\tINSERT INTO &Table\n\t\t(\n\t\t\tUSER_ID,\n\t\t\tTARGET_TABLE,\n\t\t\tJOB_NAME,\n\t\t\tJOB_RC,\n\t\t\tROWS_AFFECTED,\n\t\t\tSTART_DTTM,\n\t\t\tEND_DTTM\n\t\t) \n\t\tSELECT\n\t\t\tUSER_ID,\n\t\t\tTARGET_TABLE,\n\t\t\tJOB_NAME,\n\t\t\tJOB_RC,\n\t\t\tROWS_AFFECTED,\n\t\t\tSTART_DTTM,\n\t\t\tEND_DTTM\n\t\tFROM\n\t\t\tWORK.JOB_STATUS;\n\tQUIT;\n\n\t%SYMDEL JOB_NAME TARGET_TABLE START_DTTM END_DTTM /nowarn;\n%mend;\n\n%StoreRuntimeInformation\n\t(\n\t\tTable=&output_table\n\t);\n","snippet":"","resource":false,"dependencies":["c0c3ce8b-0c56-4450-8487-b5b00af1ba24"]},"properties":{"left":"430","top":"30","width":"100","height":"60","region":"output","fillcolor":"#E0E6F1","linecolor":"#6882a3","tooltip":"Store Job Status","portsonly":true,"key":"control","visible":true}}],"ports":[{"version":2,"type":"port","id":"2b71b721-79f9-43d8-8b47-d69322540081","name":"","label":"","description":"","created":1666039188466,"modified":1666039188482,"notes":"","parameters":{},"properties":{"left":"30","top":"53","width":"13","height":"13","parent":"6decdbae-1583-4cff-814d-bc32775e0a07","region":"input","readonly":false,"disabled":false,"fillcolor":"#E0E6F1","linecolor":"#6882a3","key":"control"}},{"version":2,"type":"port","id":"ce0e41ee-93ff-4cff-8def-4fe08ce1dd65","name":"","label":"","description":"","created":1666039188482,"modified":1666039188483,"notes":"","parameters":{},"properties":{"left":"157","top":"53","width":"13","height":"13","parent":"6decdbae-1583-4cff-814d-bc32775e0a07","region":"output","readonly":false,"disabled":false,"fillcolor":"#E0E6F1","linecolor":"#6882a3","key":"control"}},{"version":2,"type":"port","id":"e9ddb73f-12ff-4d8b-83ca-75916a633696","name":"","label":"","description":"","created":1666039663424,"modified":1666040341280,"notes":"","parameters":{},"properties":{"left":"220","top":"53","width":"13","height":"13","parent":"c0c3ce8b-0c56-4450-8487-b5b00af1ba24","region":"input","readonly":false,"disabled":false,"fillcolor":"#E0E6F1","linecolor":"#6882a3","key":"control"}},{"version":2,"type":"port","id":"ab6697e5-28a5-43d3-8a84-6ed2cf2e421a","name":"","label":"","description":"","created":1666039663425,"modified":1666040341280,"notes":"","parameters":{},"properties":{"left":"347","top":"53","width":"13","height":"13","parent":"c0c3ce8b-0c56-4450-8487-b5b00af1ba24","region":"output","readonly":false,"disabled":false,"fillcolor":"#E0E6F1","linecolor":"#6882a3","key":"control"}},{"version":2,"type":"port","id":"a587f6f9-b195-4025-8992-277b94d9f392","name":"","label":"","description":"","created":1666039314808,"modified":1666040341281,"notes":"","parameters":{},"properties":{"left":"410","top":"53","width":"13","height":"13","parent":"69259c90-e290-4c0e-8847-6e67bbb04dc2","region":"input","readonly":false,"disabled":false,"fillcolor":"#E0E6F1","linecolor":"#6882a3","key":"control"}},{"version":2,"type":"port","id":"bdacf18a-c7e7-41dd-877d-393a1d5bb87b","name":"","label":"","description":"","created":1666039314810,"modified":1666040341281,"notes":"","parameters":{},"properties":{"left":"537","top":"53","width":"13","height":"13","parent":"69259c90-e290-4c0e-8847-6e67bbb04dc2","region":"output","readonly":false,"disabled":false,"fillcolor":"#E0E6F1","linecolor":"#6882a3","key":"control"}}],"connectors":[{"version":2,"type":"link","id":"44b688c2-4262-4793-805f-b26dc9f5e777","name":"","label":"","description":"","created":1666039667832,"modified":1666039667832,"notes":"","parameters":{},"properties":{"linecolor":"#C0C0C0","linestyle":"Dash"},"sources":[{"value":"ce0e41ee-93ff-4cff-8def-4fe08ce1dd65"}],"targets":[{"value":"e9ddb73f-12ff-4d8b-83ca-75916a633696"}]},{"version":2,"type":"link","id":"23123fb5-1a82-49e0-851e-f37911822b1c","name":"","label":"","description":"","created":1666039670271,"modified":1666039670271,"notes":"","parameters":{},"properties":{"linecolor":"#C0C0C0","linestyle":"Dash"},"sources":[{"value":"ab6697e5-28a5-43d3-8a84-6ed2cf2e421a"}],"targets":[{"value":"a587f6f9-b195-4025-8992-277b94d9f392"}]}]}